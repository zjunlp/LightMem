## 目标

* 创建 `scripts/summarize_results.py`，汇总 `result_*.json` 为精简报告：正确率、平均构建耗时、每集合向量数量及总体统计。

## 输入与参数

* 结果目录：`--results-dir`（默认 `../results`，相对于项目根或当前工作目录）

* Qdrant 数据根：`--qdrant-dir`（默认 `./qdrant_data`）

* 输出路径：`--out`（默认 `./reports/summary.json`，自动创建目录）

## 统计项

* 样本总数、`correct` 总计与 `accuracy = correct/total`

* `construction_time` 平均值（忽略缺失或非数值条目）

* 每集合向量数量：对每个 `question_id`，连接本地 Qdrant 嵌入式存储并统计该集合的点数

  * 连接方式：`QdrantClient(path=os.path.join(qdrant_dir, question_id))`

  * 计数：`client.count(collection_name=question_id, exact=True).count`

  * 异常处理：集合不存在或无法连接时计为 0，并在 `missing_collections` 列出

* 汇总统计：向量总数、平均每集合向量数、Top-N（如前10）集合按向量数排序列表

## 脚本实现

* 遍历 `results_dir` 的 `result_*.json`，解析字段：`question_id`、`correct`、`construction_time`

* 对每个 `question_id` 执行 Qdrant 计数（本地嵌入式模式），收集 `vector_counts`

* 产出 JSON 报告结构：

  * `total_samples`, `correct_count`, `accuracy`

  * `avg_construction_time`

  * `vector_counts`（字典：`qid -> count`）

  * `total_vectors`, `avg_vectors_per_collection`

  * `top_collections_by_vectors`（含 `qid` 与 `count`）

  * `missing_collections`（列表）

* 控制台打印简要摘要（总样本、正确率、平均耗时、总向量数）

## 验证与使用

* 运行命令：

  * `py -3.9 scripts\summarize_results.py --results-dir ../results --qdrant-dir ./qdrant_data --out ./reports/summary.json`

* 验证输出文件存在且内容完整；必要时补充 `summary.md` 的人类可读摘要（可选）

## 注意事项

* Windows 路径分隔符与编码：读取 JSON 使用 `encoding='utf-8'`

* Qdrant 嵌入式按集合独立目录初始化客户端；若你的环境改为统一根路径，需要将连接逻辑切换为 `QdrantClient(path=qdrant_dir)` 并直接 `count(question_id)`

* 大规模结果时建议增加进度条与并行计数（第一版先串行保证稳定）

